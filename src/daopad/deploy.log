================================================
DAOPad Deployment
================================================
Network: ic
Target: all
Fresh deploy: false
Working from: /home/theseus/alexandria/daopad-settings-e2e-tests

Mainnet Canister IDs:
  Backend:  lwsav-iiaaa-aaaap-qp2qq-cai
  Frontend: l7rlj-6aaaa-aaaaa-qaffq-cai
  Alexandria Station: fec7w-zyaaa-aaaaa-qaffq-cai
================================================

Switching to daopad identity for mainnet deployment...
Using identity: "daopad".
Using identity: daopad


Building DAOPad backend...
   Compiling proc-macro2 v1.0.95
   Compiling unicode-ident v1.0.18
   Compiling typenum v1.18.0
   Compiling version_check v0.9.5
   Compiling serde v1.0.219
   Compiling autocfg v1.5.0
   Compiling crc32fast v1.5.0
   Compiling thiserror v1.0.69
   Compiling shlex v1.3.0
   Compiling syn v1.0.109
   Compiling rustversion v1.0.21
   Compiling anyhow v1.0.98
   Compiling either v1.15.0
   Compiling cfg-if v1.0.1
   Compiling paste v1.0.15
   Compiling lazy_static v1.5.0
   Compiling libc v0.2.174
   Compiling cpufeatures v0.2.17
   Compiling arrayvec v0.5.2
   Compiling data-encoding v2.9.0
   Compiling cc v1.2.29
   Compiling futures-core v0.3.31
   Compiling generic-array v0.14.7
   Compiling unicode-width v0.1.14
   Compiling memchr v2.7.5
   Compiling num-traits v0.2.19
   Compiling futures-sink v0.3.31
   Compiling typed-arena v2.0.2
   Compiling futures-channel v0.3.31
   Compiling pretty v0.12.4
   Compiling leb128 v0.2.5
   Compiling futures-io v0.3.31
   Compiling quote v1.0.40
   Compiling slab v0.4.11
   Compiling ic-cdk-executor v0.1.0
   Compiling futures-task v0.3.31
   Compiling hex v0.4.3
   Compiling byteorder v1.5.0
   Compiling syn v2.0.104
   Compiling pin-utils v0.1.0
   Compiling pin-project-lite v0.2.16
   Compiling serde_json v1.0.143
   Compiling itoa v1.0.15
   Compiling ryu v1.0.20
   Compiling num-integer v0.1.46
   Compiling ic0 v0.23.0
   Compiling crypto-common v0.1.6
   Compiling block-buffer v0.10.4
   Compiling psm v0.1.26
   Compiling stacker v0.1.21
   Compiling digest v0.10.7
   Compiling sha2 v0.10.9
   Compiling binread_derive v2.1.0
   Compiling serde_derive v1.0.219
   Compiling thiserror-impl v1.0.69
   Compiling candid_derive v0.10.18
   Compiling futures-macro v0.3.31
   Compiling binread v2.2.0
   Compiling futures-util v0.3.31
   Compiling futures-executor v0.3.31
   Compiling futures v0.3.31
   Compiling ic_principal v0.1.1
   Compiling serde_bytes v0.11.17
   Compiling num-bigint v0.4.6
   Compiling serde_tokenstream v0.2.2
   Compiling ic-stable-structures v0.6.9
   Compiling candid v0.10.18
   Compiling ic-cdk-macros v0.17.2
   Compiling ic-cdk v0.17.2
   Compiling daopad_backend v0.1.0 (/home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_backend)
    Finished `release` profile [optimized] target(s) in 49.68s
Extracting Candid interface for daopad_backend...
‚úì Candid interface extracted
Deploying daopad_backend...
Deploying daopad_backend to mainnet...
Deploying: daopad_backend
All canisters have already been created.
WARN: .did file for canister 'kong_locker_frontend' does not exist.
WARN: .did file for canister 'kong_locker' does not exist.
WARN: .did file for canister 'daopad_frontend' does not exist.
Checking for vulnerabilities in rust canisters.
[0m[0m[1m[32m    Fetching[0m advisory database from `https://github.com/RustSec/advisory-db.git`
[0m[0m[1m[32m      Loaded[0m 858 security advisories (from /home/theseus/.cargo/advisory-db)
[0m[0m[1m[32m    Updating[0m crates.io index
[0m[0m[1m[32m    Scanning[0m Cargo.lock for vulnerabilities (80 crate dependencies)
[0m[0m[1m[33mCrate:    [0m paste
[0m[0m[1m[33mVersion:  [0m 1.0.15
[0m[0m[1m[33mWarning:  [0m unmaintained
[0m[0m[1m[33mTitle:    [0m paste - no longer maintained
[0m[0m[1m[33mDate:     [0m 2024-10-07
[0m[0m[1m[33mID:       [0m RUSTSEC-2024-0436
[0m[0m[1m[33mURL:      [0m https://rustsec.org/advisories/RUSTSEC-2024-0436
[0m[0m[1m[33mDependency tree:
[0mpaste 1.0.15
‚îî‚îÄ‚îÄ candid 0.10.18
    ‚îú‚îÄ‚îÄ ic-cdk-macros 0.17.2
    ‚îÇ   ‚îî‚îÄ‚îÄ ic-cdk 0.17.2
    ‚îÇ       ‚îî‚îÄ‚îÄ daopad_backend 0.1.0
    ‚îú‚îÄ‚îÄ ic-cdk 0.17.2
    ‚îî‚îÄ‚îÄ daopad_backend 0.1.0

[0m[0m[1m[33mwarning:[0m 1 allowed warning found
Audit found no vulnerabilities.
Building canister 'daopad_backend'.
Executing: cargo build --target wasm32-unknown-unknown --release -p daopad_backend --locked
    Finished `release` profile [optimized] target(s) in 0.04s
Module hash 0bd1982a3f9763360352eb1fad2f314fc6e321633567b9098d86c4899a711cd6 is already installed.
Upgraded code for canister daopad_backend, with canister ID lwsav-iiaaa-aaaap-qp2qq-cai
Deployed canisters.
URLs:
  Frontend canister via browser:
    daopad_frontend: https://l7rlj-6aaaa-aaaap-qp2ra-cai.icp0.io/
    kong_locker_frontend: https://c6w56-taaaa-aaaai-atlma-cai.icp0.io/
  Backend canister via Candid interface:
    daopad_backend: https://a4gq6-oaaaa-aaaab-qaa4q-cai.raw.icp0.io/?id=lwsav-iiaaa-aaaap-qp2qq-cai
    kong_locker: https://a4gq6-oaaaa-aaaab-qaa4q-cai.raw.icp0.io/?id=eazgb-giaaa-aaaap-qqc2q-cai
‚úì DAOPad backend deployed successfully

==================================================
üîÑ Syncing Backend Declarations to Frontend
==================================================
‚ö†Ô∏è  WARNING: Source declarations not found at src/declarations/daopad_backend
Make sure you ran candid-extractor before deploying.
Run: cargo build --target wasm32-unknown-unknown --release -p daopad_backend
Then: candid-extractor target/wasm32-unknown-unknown/release/daopad_backend.wasm > src/daopad/daopad_backend/daopad_backend.did


Building DAOPad frontend...
npm warn deprecated abab@2.0.6: Use your platform's native atob() and btoa() methods instead
npm warn deprecated domexception@4.0.0: Use your platform's native DOMException instead
npm warn deprecated node-domexception@1.0.0: Use your platform's native DOMException instead

added 807 packages, and audited 808 packages in 4s

225 packages are looking for funding
  run `npm fund` for details

1 moderate severity vulnerability

To address all issues, run:
  npm audit fix

Run `npm audit` for details.
Generating backend declarations...
Generated type declarations for canister 'daopad_backend' to '/home/theseus/alexandria/daopad-settings-e2e-tests/src/declarations/daopad_backend'
üîÑ Syncing declarations to frontend...
‚ö†Ô∏è  Warning: Could not sync declarations (directories not found)

> daopad_frontend@0.0.0 prebuild
> node -e "console.log('Skipping dfx generate: declarations vendored locally')"

Skipping dfx generate: declarations vendored locally

> daopad_frontend@0.0.0 build
> npm run test:toast && vite build


> daopad_frontend@0.0.0 test:toast
> node test-toast-integration.mjs

‚úÖ All toast API calls use correct sonner syntax
vite v6.3.5 building for production...
transforming...
‚úì 1856 modules transformed.
‚úó Build failed in 2.21s
error during build:
Could not resolve "../../../declarations/daopad_backend" from "src/services/backend/base/BackendServiceBase.ts"
file: /home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_frontend/src/services/backend/base/BackendServiceBase.ts
    at getRollupError (file:///home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_frontend/node_modules/rollup/dist/es/shared/parseAst.js:401:41)
    at error (file:///home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_frontend/node_modules/rollup/dist/es/shared/parseAst.js:397:42)
    at ModuleLoader.handleInvalidResolvedId (file:///home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_frontend/node_modules/rollup/dist/es/shared/node-entry.js:21534:24)
    at file:///home/theseus/alexandria/daopad-settings-e2e-tests/src/daopad/daopad_frontend/node_modules/rollup/dist/es/shared/node-entry.js:21494:26
‚ùå Frontend build failed!
